
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "generated/autoexamples/01.Phantoms/example_cbs_neuro.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_generated_autoexamples_01.Phantoms_example_cbs_neuro.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_generated_autoexamples_01.Phantoms_example_cbs_neuro.py:


================================================
Open Science CBS Neuroimaging Repository Phantom
================================================

Example of Open Science CBS Neuroimaging Repository phantom creation.

This dataset consists of an additional processing of the dataset created
by Tardif et al. [1], and stored `in a Open Science Framework (OSF) repository <https://osf.io/qkbca/>`_.

This examples show how to generate numerical phantoms based on the Brainweb
dataset.

References
----------
[1] Tardif CL, Schäfer A, Trampel R, Villringer A, Turner R, Bazin PL. 
Open Science CBS Neuroimaging Repository: Sharing ultra-high-field MR images of the brain. 
Neuroimage. 2016 Jan 1;124(Pt B):1143-1148. doi: 10.1016/j.neuroimage.2015.08.042. 
Epub 2015 Aug 25. PMID: 26318051.

.. GENERATED FROM PYTHON SOURCE LINES 22-28

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    from mrtwin import osf_phantom








.. GENERATED FROM PYTHON SOURCE LINES 29-36

Basic Usage
===========
The Open Science CBS Neuroimaging database (hereafter referred to as `OSF`)
consists of a set of 20 normal brains (ids equal to ``[1-4, 6, 8-15, 17, 19, 22-23, 25, 27-28]``)
at a nominal 0.5 mm isotropic and a shape of ``(nz, ny, nx) = (454, 544, 454)``.

A digital OSF phantom can be created as:

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: Python


    phantom = osf_phantom(ndim=2, subject=1)  # 2D phantom





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0.00/196M [00:00<?, ?bytes/s]      0%|          | 16.4k/196M [00:00<27:39, 118kbytes/s]      0%|          | 49.2k/196M [00:00<21:06, 155kbytes/s]      0%|          | 81.9k/196M [00:00<19:46, 165kbytes/s]      0%|          | 147k/196M [00:00<11:55, 274kbytes/s]       0%|          | 213k/196M [00:00<09:09, 357kbytes/s]      0%|          | 328k/196M [00:00<05:52, 555kbytes/s]      0%|          | 475k/196M [00:00<04:08, 787kbytes/s]      0%|          | 737k/196M [00:01<02:33, 1.27Mbytes/s]      1%|          | 1.10M/196M [00:01<01:41, 1.91Mbytes/s]      1%|          | 1.67M/196M [00:01<01:05, 2.99Mbytes/s]      1%|▏         | 2.57M/196M [00:01<00:41, 4.72Mbytes/s]      2%|▏         | 3.92M/196M [00:01<00:26, 7.24Mbytes/s]      3%|▎         | 5.98M/196M [00:01<00:17, 11.2Mbytes/s]      4%|▍         | 8.49M/196M [00:01<00:12, 15.2Mbytes/s]      6%|▌         | 11.0M/196M [00:01<00:10, 18.2Mbytes/s]      7%|▋         | 13.4M/196M [00:01<00:09, 19.9Mbytes/s]      8%|▊         | 16.2M/196M [00:02<00:08, 21.1Mbytes/s]     10%|▉         | 18.8M/196M [00:02<00:08, 21.8Mbytes/s]     11%|█         | 21.3M/196M [00:02<00:07, 22.7Mbytes/s]     12%|█▏        | 24.0M/196M [00:02<00:07, 23.3Mbytes/s]     14%|█▎        | 26.5M/196M [00:02<00:07, 23.5Mbytes/s]     15%|█▍        | 29.1M/196M [00:02<00:07, 23.9Mbytes/s]     16%|█▌        | 31.7M/196M [00:02<00:06, 24.1Mbytes/s]     17%|█▋        | 34.3M/196M [00:02<00:06, 24.0Mbytes/s]     19%|█▊        | 36.7M/196M [00:02<00:06, 24.0Mbytes/s]     20%|██        | 39.4M/196M [00:02<00:06, 24.3Mbytes/s]     21%|██▏       | 42.0M/196M [00:03<00:06, 24.1Mbytes/s]     23%|██▎       | 44.6M/196M [00:03<00:06, 24.2Mbytes/s]     24%|██▍       | 47.1M/196M [00:03<00:06, 24.2Mbytes/s]     25%|██▌       | 49.6M/196M [00:03<00:06, 24.1Mbytes/s]     27%|██▋       | 52.2M/196M [00:03<00:05, 24.1Mbytes/s]     28%|██▊       | 54.8M/196M [00:03<00:05, 24.3Mbytes/s]     29%|██▉       | 57.3M/196M [00:03<00:05, 24.1Mbytes/s]     31%|███       | 59.9M/196M [00:03<00:05, 24.1Mbytes/s]     32%|███▏      | 62.4M/196M [00:03<00:05, 24.3Mbytes/s]     33%|███▎      | 65.0M/196M [00:04<00:05, 24.0Mbytes/s]     34%|███▍      | 67.5M/196M [00:04<00:05, 24.2Mbytes/s]     36%|███▌      | 70.1M/196M [00:04<00:05, 24.1Mbytes/s]     37%|███▋      | 72.6M/196M [00:04<00:05, 24.1Mbytes/s]     38%|███▊      | 75.0M/196M [00:04<00:05, 22.8Mbytes/s]     40%|███▉      | 78.1M/196M [00:04<00:04, 25.0Mbytes/s]     41%|████      | 80.7M/196M [00:04<00:04, 25.0Mbytes/s]     42%|████▏     | 83.2M/196M [00:04<00:04, 23.7Mbytes/s]     44%|████▍     | 86.1M/196M [00:04<00:04, 25.2Mbytes/s]     45%|████▌     | 88.7M/196M [00:04<00:04, 25.2Mbytes/s]     46%|████▋     | 91.2M/196M [00:05<00:04, 23.8Mbytes/s]     48%|████▊     | 93.9M/196M [00:05<00:04, 24.8Mbytes/s]     49%|████▉     | 96.6M/196M [00:05<00:03, 25.2Mbytes/s]     51%|█████     | 99.1M/196M [00:05<00:04, 23.9Mbytes/s]     52%|█████▏    | 102M/196M [00:05<00:03, 25.0Mbytes/s]      53%|█████▎    | 104M/196M [00:05<00:03, 25.2Mbytes/s]     55%|█████▍    | 107M/196M [00:05<00:03, 23.9Mbytes/s]     56%|█████▌    | 110M/196M [00:05<00:03, 22.2Mbytes/s]     58%|█████▊    | 113M/196M [00:05<00:03, 24.6Mbytes/s]     59%|█████▉    | 115M/196M [00:06<00:03, 24.5Mbytes/s]     60%|██████    | 118M/196M [00:06<00:03, 23.4Mbytes/s]     62%|██████▏   | 121M/196M [00:06<00:03, 24.7Mbytes/s]     63%|██████▎   | 124M/196M [00:06<00:02, 25.9Mbytes/s]     64%|██████▍   | 127M/196M [00:06<00:02, 24.6Mbytes/s]     66%|██████▌   | 129M/196M [00:06<00:02, 24.6Mbytes/s]     67%|██████▋   | 131M/196M [00:06<00:02, 24.6Mbytes/s]     68%|██████▊   | 134M/196M [00:06<00:02, 23.6Mbytes/s]     70%|██████▉   | 137M/196M [00:06<00:02, 24.6Mbytes/s]     71%|███████   | 139M/196M [00:07<00:02, 24.7Mbytes/s]     72%|███████▏  | 142M/196M [00:07<00:02, 23.6Mbytes/s]     74%|███████▎  | 144M/196M [00:07<00:02, 24.5Mbytes/s]     75%|███████▍  | 147M/196M [00:07<00:02, 24.5Mbytes/s]     76%|███████▌  | 149M/196M [00:07<00:01, 23.7Mbytes/s]     77%|███████▋  | 152M/196M [00:07<00:01, 24.2Mbytes/s]     79%|███████▊  | 154M/196M [00:07<00:01, 23.6Mbytes/s]     80%|███████▉  | 157M/196M [00:07<00:01, 23.6Mbytes/s]     81%|████████▏ | 160M/196M [00:07<00:01, 24.5Mbytes/s]     83%|████████▎ | 162M/196M [00:08<00:01, 23.9Mbytes/s]     84%|████████▍ | 164M/196M [00:08<00:01, 23.9Mbytes/s]     85%|████████▌ | 167M/196M [00:08<00:01, 24.7Mbytes/s]     87%|████████▋ | 170M/196M [00:08<00:01, 24.1Mbytes/s]     88%|████████▊ | 172M/196M [00:08<00:00, 24.0Mbytes/s]     89%|████████▉ | 175M/196M [00:08<00:00, 24.8Mbytes/s]     90%|█████████ | 178M/196M [00:08<00:00, 24.2Mbytes/s]     92%|█████████▏| 180M/196M [00:08<00:00, 23.5Mbytes/s]     93%|█████████▎| 183M/196M [00:08<00:00, 25.2Mbytes/s]     95%|█████████▍| 185M/196M [00:08<00:00, 24.6Mbytes/s]     96%|█████████▌| 188M/196M [00:09<00:00, 23.7Mbytes/s]     97%|█████████▋| 190M/196M [00:09<00:00, 23.0Mbytes/s]     98%|█████████▊| 193M/196M [00:09<00:00, 20.3Mbytes/s]    100%|█████████▉| 196M/196M [00:09<00:00, 21.0Mbytes/s]    100%|██████████| 196M/196M [00:09<00:00, 20.7Mbytes/s]
      0%|          | 0.00/197M [00:00<?, ?bytes/s]      0%|          | 16.4k/197M [00:00<24:30, 134kbytes/s]      0%|          | 49.2k/197M [00:00<20:06, 163kbytes/s]      0%|          | 81.9k/197M [00:00<19:08, 171kbytes/s]      0%|          | 147k/197M [00:00<11:44, 279kbytes/s]       0%|          | 213k/197M [00:00<08:57, 366kbytes/s]      0%|          | 328k/197M [00:00<05:49, 561kbytes/s]      0%|          | 459k/197M [00:00<04:16, 764kbytes/s]      0%|          | 705k/197M [00:01<02:38, 1.24Mbytes/s]      1%|          | 1.05M/197M [00:01<01:45, 1.85Mbytes/s]      1%|          | 1.61M/197M [00:01<01:07, 2.91Mbytes/s]      1%|▏         | 2.47M/197M [00:01<00:42, 4.56Mbytes/s]      2%|▏         | 3.24M/197M [00:01<00:35, 5.43Mbytes/s]      3%|▎         | 5.85M/197M [00:01<00:16, 11.4Mbytes/s]      4%|▍         | 8.50M/197M [00:01<00:12, 15.5Mbytes/s]      6%|▌         | 11.0M/197M [00:01<00:10, 17.8Mbytes/s]      7%|▋         | 13.6M/197M [00:01<00:09, 19.9Mbytes/s]      8%|▊         | 16.2M/197M [00:01<00:08, 21.3Mbytes/s]     10%|▉         | 18.7M/197M [00:02<00:08, 22.0Mbytes/s]     11%|█         | 21.3M/197M [00:02<00:07, 22.8Mbytes/s]     12%|█▏        | 23.9M/197M [00:02<00:07, 23.4Mbytes/s]     13%|█▎        | 26.4M/197M [00:02<00:07, 23.4Mbytes/s]     15%|█▍        | 29.0M/197M [00:02<00:07, 23.9Mbytes/s]     16%|█▌        | 31.6M/197M [00:02<00:06, 24.1Mbytes/s]     17%|█▋        | 34.2M/197M [00:02<00:06, 23.9Mbytes/s]     19%|█▊        | 36.7M/197M [00:02<00:06, 24.2Mbytes/s]     20%|██        | 39.3M/197M [00:02<00:06, 24.3Mbytes/s]     21%|██▏       | 41.9M/197M [00:03<00:06, 24.1Mbytes/s]     23%|██▎       | 44.5M/197M [00:03<00:06, 24.0Mbytes/s]     24%|██▍       | 47.0M/197M [00:03<00:06, 24.3Mbytes/s]     25%|██▌       | 49.6M/197M [00:03<00:06, 24.3Mbytes/s]     27%|██▋       | 52.2M/197M [00:03<00:05, 24.2Mbytes/s]     28%|██▊       | 54.8M/197M [00:03<00:05, 24.6Mbytes/s]     29%|██▉       | 57.4M/197M [00:03<00:05, 24.5Mbytes/s]     31%|███       | 60.0M/197M [00:03<00:05, 24.2Mbytes/s]     32%|███▏      | 62.6M/197M [00:03<00:05, 24.7Mbytes/s]     33%|███▎      | 65.2M/197M [00:03<00:05, 24.5Mbytes/s]     35%|███▍      | 67.8M/197M [00:04<00:05, 24.3Mbytes/s]     36%|███▌      | 70.5M/197M [00:04<00:05, 25.0Mbytes/s]     37%|███▋      | 73.1M/197M [00:04<00:05, 24.5Mbytes/s]     38%|███▊      | 75.7M/197M [00:04<00:04, 24.3Mbytes/s]     40%|███▉      | 78.5M/197M [00:04<00:04, 25.3Mbytes/s]     41%|████      | 81.0M/197M [00:04<00:04, 24.7Mbytes/s]     42%|████▏     | 83.5M/197M [00:04<00:04, 24.1Mbytes/s]     44%|████▍     | 86.4M/197M [00:04<00:04, 25.5Mbytes/s]     45%|████▌     | 89.0M/197M [00:04<00:04, 24.8Mbytes/s]     47%|████▋     | 91.5M/197M [00:05<00:04, 24.2Mbytes/s]     48%|████▊     | 94.3M/197M [00:05<00:04, 24.4Mbytes/s]     49%|████▉     | 96.8M/197M [00:05<00:04, 24.6Mbytes/s]     50%|█████     | 99.3M/197M [00:05<00:04, 24.0Mbytes/s]     52%|█████▏    | 102M/197M [00:05<00:04, 21.3Mbytes/s]      53%|█████▎    | 104M/197M [00:05<00:04, 20.0Mbytes/s]     55%|█████▍    | 108M/197M [00:05<00:04, 21.5Mbytes/s]     57%|█████▋    | 112M/197M [00:05<00:03, 22.2Mbytes/s]     59%|█████▉    | 116M/197M [00:06<00:03, 23.0Mbytes/s]     61%|██████    | 120M/197M [00:06<00:03, 23.5Mbytes/s]     63%|██████▎   | 124M/197M [00:06<00:03, 23.9Mbytes/s]     64%|██████▍   | 126M/197M [00:06<00:03, 19.2Mbytes/s]     65%|██████▌   | 128M/197M [00:06<00:03, 19.1Mbytes/s]     67%|██████▋   | 131M/197M [00:06<00:03, 20.0Mbytes/s]     69%|██████▉   | 135M/197M [00:07<00:02, 21.4Mbytes/s]     71%|███████   | 139M/197M [00:07<00:02, 22.3Mbytes/s]     73%|███████▎  | 143M/197M [00:07<00:02, 22.9Mbytes/s]     75%|███████▍  | 147M/197M [00:07<00:02, 23.4Mbytes/s]     77%|███████▋  | 151M/197M [00:07<00:01, 23.7Mbytes/s]     79%|███████▊  | 154M/197M [00:07<00:01, 23.8Mbytes/s]     81%|████████  | 158M/197M [00:08<00:01, 23.9Mbytes/s]     82%|████████▏ | 162M/197M [00:08<00:01, 24.0Mbytes/s]     84%|████████▍ | 166M/197M [00:08<00:01, 24.0Mbytes/s]     86%|████████▋ | 170M/197M [00:08<00:01, 24.1Mbytes/s]     88%|████████▊ | 174M/197M [00:08<00:00, 24.2Mbytes/s]     90%|█████████ | 178M/197M [00:08<00:00, 24.2Mbytes/s]     92%|█████████▏| 181M/197M [00:09<00:00, 24.2Mbytes/s]     94%|█████████▍| 185M/197M [00:09<00:00, 24.3Mbytes/s]     96%|█████████▌| 189M/197M [00:09<00:00, 24.4Mbytes/s]     98%|█████████▊| 193M/197M [00:09<00:00, 24.5Mbytes/s]    100%|██████████| 197M/197M [00:09<00:00, 20.5Mbytes/s]
      0%|          | 0.00/196M [00:00<?, ?bytes/s]      0%|          | 16.4k/196M [00:00<27:38, 118kbytes/s]      0%|          | 49.2k/196M [00:00<21:10, 154kbytes/s]      0%|          | 81.9k/196M [00:00<19:44, 165kbytes/s]      0%|          | 147k/196M [00:00<11:53, 274kbytes/s]       0%|          | 213k/196M [00:00<09:07, 358kbytes/s]      0%|          | 328k/196M [00:00<05:51, 557kbytes/s]      0%|          | 475k/196M [00:00<04:08, 786kbytes/s]      0%|          | 737k/196M [00:01<02:32, 1.28Mbytes/s]      1%|          | 1.08M/196M [00:01<01:43, 1.88Mbytes/s]      1%|          | 1.65M/196M [00:01<01:05, 2.98Mbytes/s]      1%|▏         | 2.54M/196M [00:01<00:41, 4.67Mbytes/s]      2%|▏         | 3.88M/196M [00:01<00:26, 7.22Mbytes/s]      3%|▎         | 5.98M/196M [00:01<00:16, 11.2Mbytes/s]      4%|▍         | 8.49M/196M [00:01<00:12, 15.3Mbytes/s]      6%|▌         | 11.0M/196M [00:01<00:10, 18.1Mbytes/s]      7%|▋         | 13.6M/196M [00:01<00:09, 19.7Mbytes/s]      8%|▊         | 16.2M/196M [00:01<00:08, 21.3Mbytes/s]     10%|▉         | 18.7M/196M [00:02<00:07, 22.4Mbytes/s]     11%|█         | 21.3M/196M [00:02<00:07, 22.7Mbytes/s]     12%|█▏        | 23.9M/196M [00:02<00:07, 23.2Mbytes/s]     13%|█▎        | 26.2M/196M [00:02<00:07, 22.7Mbytes/s]     15%|█▍        | 29.0M/196M [00:02<00:06, 23.9Mbytes/s]     16%|█▌        | 31.5M/196M [00:02<00:06, 24.2Mbytes/s]     17%|█▋        | 33.9M/196M [00:02<00:06, 23.5Mbytes/s]     19%|█▊        | 36.7M/196M [00:02<00:06, 24.3Mbytes/s]     20%|██        | 39.2M/196M [00:02<00:06, 24.6Mbytes/s]     21%|██▏       | 41.7M/196M [00:03<00:06, 23.7Mbytes/s]     23%|██▎       | 44.4M/196M [00:03<00:06, 24.4Mbytes/s]     24%|██▍       | 46.9M/196M [00:03<00:06, 24.7Mbytes/s]     25%|██▌       | 49.4M/196M [00:03<00:06, 23.8Mbytes/s]     27%|██▋       | 52.1M/196M [00:03<00:05, 24.1Mbytes/s]     28%|██▊       | 55.0M/196M [00:03<00:05, 25.6Mbytes/s]     29%|██▉       | 57.6M/196M [00:03<00:05, 24.5Mbytes/s]     31%|███       | 60.1M/196M [00:03<00:05, 24.2Mbytes/s]     32%|███▏      | 62.8M/196M [00:03<00:05, 23.8Mbytes/s]     34%|███▎      | 65.8M/196M [00:04<00:05, 25.2Mbytes/s]     35%|███▍      | 68.4M/196M [00:04<00:05, 23.3Mbytes/s]     36%|███▋      | 71.5M/196M [00:04<00:05, 23.6Mbytes/s]     38%|███▊      | 74.4M/196M [00:04<00:04, 24.4Mbytes/s]     40%|███▉      | 77.4M/196M [00:04<00:04, 25.5Mbytes/s]     41%|████      | 80.0M/196M [00:04<00:04, 23.5Mbytes/s]     42%|████▏     | 83.0M/196M [00:04<00:04, 23.8Mbytes/s]     44%|████▍     | 86.0M/196M [00:04<00:04, 24.5Mbytes/s]     45%|████▌     | 88.9M/196M [00:04<00:04, 25.5Mbytes/s]     47%|████▋     | 91.5M/196M [00:05<00:04, 23.1Mbytes/s]     48%|████▊     | 94.6M/196M [00:05<00:04, 24.1Mbytes/s]     50%|████▉     | 97.6M/196M [00:05<00:03, 24.6Mbytes/s]     51%|█████     | 100M/196M [00:05<00:03, 25.0Mbytes/s]      52%|█████▏    | 103M/196M [00:05<00:04, 22.4Mbytes/s]     54%|█████▎    | 105M/196M [00:05<00:04, 21.0Mbytes/s]     55%|█████▌    | 108M/196M [00:05<00:04, 20.9Mbytes/s]     57%|█████▋    | 112M/196M [00:06<00:03, 22.2Mbytes/s]     59%|█████▉    | 116M/196M [00:06<00:03, 23.0Mbytes/s]     61%|██████    | 120M/196M [00:06<00:03, 22.1Mbytes/s]     62%|██████▏   | 122M/196M [00:06<00:03, 19.4Mbytes/s]     63%|██████▎   | 124M/196M [00:06<00:04, 17.6Mbytes/s]     65%|██████▌   | 128M/196M [00:06<00:03, 19.4Mbytes/s]     67%|██████▋   | 131M/196M [00:07<00:03, 21.0Mbytes/s]     69%|██████▉   | 135M/196M [00:07<00:02, 22.0Mbytes/s]     71%|███████   | 139M/196M [00:07<00:02, 22.7Mbytes/s]     73%|███████▎  | 143M/196M [00:07<00:02, 23.2Mbytes/s]     75%|███████▍  | 147M/196M [00:07<00:02, 23.5Mbytes/s]     77%|███████▋  | 150M/196M [00:07<00:01, 25.9Mbytes/s]     78%|███████▊  | 153M/196M [00:07<00:01, 26.6Mbytes/s]     80%|███████▉  | 156M/196M [00:07<00:01, 24.3Mbytes/s]     81%|████████  | 158M/196M [00:08<00:01, 22.7Mbytes/s]     82%|████████▏ | 162M/196M [00:08<00:01, 24.8Mbytes/s]     84%|████████▍ | 165M/196M [00:08<00:01, 26.2Mbytes/s]     85%|████████▌ | 167M/196M [00:08<00:01, 24.3Mbytes/s]     87%|████████▋ | 170M/196M [00:08<00:01, 22.6Mbytes/s]     88%|████████▊ | 173M/196M [00:08<00:00, 24.7Mbytes/s]     90%|████████▉ | 176M/196M [00:08<00:00, 25.4Mbytes/s]     91%|█████████ | 179M/196M [00:08<00:00, 24.0Mbytes/s]     93%|█████████▎| 182M/196M [00:09<00:00, 23.0Mbytes/s]     94%|█████████▍| 185M/196M [00:09<00:00, 25.1Mbytes/s]     96%|█████████▌| 188M/196M [00:09<00:00, 26.3Mbytes/s]     97%|█████████▋| 190M/196M [00:09<00:00, 24.2Mbytes/s]     99%|█████████▊| 193M/196M [00:09<00:00, 22.9Mbytes/s]    100%|██████████| 196M/196M [00:09<00:00, 20.4Mbytes/s]
      0%|          | 0.00/195M [00:00<?, ?bytes/s]      0%|          | 16.4k/195M [00:00<27:35, 118kbytes/s]      0%|          | 49.2k/195M [00:00<20:58, 155kbytes/s]      0%|          | 81.9k/195M [00:00<19:37, 166kbytes/s]      0%|          | 147k/195M [00:00<12:02, 270kbytes/s]       0%|          | 213k/195M [00:00<08:59, 361kbytes/s]      0%|          | 328k/195M [00:00<05:49, 558kbytes/s]      0%|          | 475k/195M [00:00<04:07, 787kbytes/s]      0%|          | 737k/195M [00:01<02:31, 1.28Mbytes/s]      1%|          | 1.08M/195M [00:01<01:42, 1.89Mbytes/s]      1%|          | 1.65M/195M [00:01<01:04, 2.98Mbytes/s]      1%|▏         | 2.54M/195M [00:01<00:41, 4.66Mbytes/s]      2%|▏         | 3.88M/195M [00:01<00:26, 7.21Mbytes/s]      3%|▎         | 5.96M/195M [00:01<00:16, 11.2Mbytes/s]      4%|▍         | 8.49M/195M [00:01<00:12, 15.2Mbytes/s]      6%|▌         | 11.0M/195M [00:01<00:10, 18.2Mbytes/s]      7%|▋         | 13.4M/195M [00:01<00:09, 19.7Mbytes/s]      8%|▊         | 16.1M/195M [00:01<00:08, 21.4Mbytes/s]     10%|▉         | 18.6M/195M [00:02<00:07, 22.7Mbytes/s]     11%|█         | 20.9M/195M [00:02<00:07, 22.4Mbytes/s]     12%|█▏        | 23.5M/195M [00:02<00:07, 23.3Mbytes/s]     13%|█▎        | 26.0M/195M [00:02<00:07, 23.3Mbytes/s]     15%|█▍        | 28.5M/195M [00:02<00:07, 23.5Mbytes/s]     16%|█▌        | 31.1M/195M [00:02<00:06, 23.9Mbytes/s]     17%|█▋        | 33.6M/195M [00:02<00:06, 24.1Mbytes/s]     19%|█▊        | 36.1M/195M [00:02<00:06, 24.4Mbytes/s]     20%|█▉        | 38.8M/195M [00:02<00:06, 24.1Mbytes/s]     21%|██        | 41.3M/195M [00:03<00:06, 24.1Mbytes/s]     22%|██▏       | 43.9M/195M [00:03<00:06, 24.0Mbytes/s]     24%|██▍       | 46.4M/195M [00:03<00:06, 24.3Mbytes/s]     25%|██▌       | 49.0M/195M [00:03<00:06, 24.3Mbytes/s]     26%|██▋       | 51.6M/195M [00:03<00:05, 24.1Mbytes/s]     28%|██▊       | 54.1M/195M [00:03<00:05, 24.4Mbytes/s]     29%|██▉       | 56.7M/195M [00:03<00:05, 24.3Mbytes/s]     30%|███       | 59.2M/195M [00:03<00:05, 24.0Mbytes/s]     32%|███▏      | 61.8M/195M [00:03<00:05, 24.4Mbytes/s]     33%|███▎      | 64.4M/195M [00:03<00:05, 24.5Mbytes/s]     34%|███▍      | 67.1M/195M [00:04<00:05, 24.3Mbytes/s]     36%|███▌      | 69.6M/195M [00:04<00:05, 24.6Mbytes/s]     37%|███▋      | 72.2M/195M [00:04<00:05, 24.6Mbytes/s]     38%|███▊      | 74.8M/195M [00:04<00:04, 24.4Mbytes/s]     40%|███▉      | 77.3M/195M [00:04<00:04, 24.5Mbytes/s]     41%|████      | 79.9M/195M [00:04<00:04, 24.4Mbytes/s]     42%|████▏     | 82.3M/195M [00:04<00:04, 24.4Mbytes/s]     44%|████▎     | 85.0M/195M [00:04<00:04, 24.4Mbytes/s]     45%|████▍     | 87.6M/195M [00:04<00:04, 23.4Mbytes/s]     46%|████▋     | 90.5M/195M [00:05<00:04, 24.4Mbytes/s]     48%|████▊     | 93.1M/195M [00:05<00:04, 24.4Mbytes/s]     49%|████▉     | 95.6M/195M [00:05<00:04, 24.2Mbytes/s]     50%|█████     | 98.3M/195M [00:05<00:03, 24.5Mbytes/s]     52%|█████▏    | 101M/195M [00:05<00:04, 20.4Mbytes/s]      53%|█████▎    | 104M/195M [00:05<00:04, 20.9Mbytes/s]     55%|█████▌    | 108M/195M [00:05<00:03, 22.1Mbytes/s]     57%|█████▋    | 112M/195M [00:06<00:03, 22.8Mbytes/s]     59%|█████▉    | 115M/195M [00:06<00:03, 23.3Mbytes/s]     61%|██████    | 119M/195M [00:06<00:03, 21.8Mbytes/s]     62%|██████▏   | 122M/195M [00:06<00:03, 19.4Mbytes/s]     63%|██████▎   | 123M/195M [00:06<00:04, 17.5Mbytes/s]     65%|██████▌   | 127M/195M [00:06<00:03, 19.7Mbytes/s]     67%|██████▋   | 131M/195M [00:07<00:03, 21.2Mbytes/s]     69%|██████▉   | 135M/195M [00:07<00:02, 22.2Mbytes/s]     71%|███████▏  | 139M/195M [00:07<00:02, 22.9Mbytes/s]     73%|███████▎  | 143M/195M [00:07<00:02, 23.4Mbytes/s]     75%|███████▌  | 147M/195M [00:07<00:02, 23.8Mbytes/s]     77%|███████▋  | 151M/195M [00:07<00:01, 24.0Mbytes/s]     79%|███████▉  | 155M/195M [00:07<00:01, 24.1Mbytes/s]     81%|████████▏ | 159M/195M [00:08<00:01, 24.2Mbytes/s]     83%|████████▎ | 162M/195M [00:08<00:01, 24.2Mbytes/s]     85%|████████▌ | 166M/195M [00:08<00:01, 24.3Mbytes/s]     87%|████████▋ | 170M/195M [00:08<00:01, 24.2Mbytes/s]     89%|████████▉ | 174M/195M [00:08<00:00, 24.3Mbytes/s]     91%|█████████ | 178M/195M [00:08<00:00, 24.1Mbytes/s]     93%|█████████▎| 182M/195M [00:09<00:00, 24.3Mbytes/s]     95%|█████████▌| 186M/195M [00:09<00:00, 24.3Mbytes/s]     97%|█████████▋| 189M/195M [00:09<00:00, 24.3Mbytes/s]     99%|█████████▉| 193M/195M [00:09<00:00, 24.2Mbytes/s]    100%|██████████| 195M/195M [00:09<00:00, 20.4Mbytes/s]
      0%|          | 0.00/196M [00:00<?, ?bytes/s]      0%|          | 16.4k/196M [00:00<27:29, 119kbytes/s]      0%|          | 49.2k/196M [00:00<20:59, 155kbytes/s]      0%|          | 81.9k/196M [00:00<19:40, 166kbytes/s]      0%|          | 147k/196M [00:00<12:01, 271kbytes/s]       0%|          | 213k/196M [00:00<08:59, 362kbytes/s]      0%|          | 328k/196M [00:00<05:49, 559kbytes/s]      0%|          | 475k/196M [00:00<04:07, 788kbytes/s]      0%|          | 737k/196M [00:01<02:31, 1.29Mbytes/s]      1%|          | 1.08M/196M [00:01<01:42, 1.89Mbytes/s]      1%|          | 1.65M/196M [00:01<01:04, 2.99Mbytes/s]      1%|▏         | 2.54M/196M [00:01<00:41, 4.68Mbytes/s]      2%|▏         | 3.87M/196M [00:01<00:26, 7.18Mbytes/s]      3%|▎         | 5.96M/196M [00:01<00:16, 11.2Mbytes/s]      4%|▍         | 8.49M/196M [00:01<00:12, 15.3Mbytes/s]      6%|▌         | 11.0M/196M [00:01<00:10, 18.2Mbytes/s]      7%|▋         | 13.2M/196M [00:01<00:09, 18.8Mbytes/s]      8%|▊         | 16.1M/196M [00:01<00:08, 21.4Mbytes/s]     10%|▉         | 18.7M/196M [00:02<00:07, 22.7Mbytes/s]     11%|█         | 21.0M/196M [00:02<00:07, 22.2Mbytes/s]     12%|█▏        | 23.9M/196M [00:02<00:07, 23.6Mbytes/s]     13%|█▎        | 26.2M/196M [00:02<00:07, 23.4Mbytes/s]     15%|█▍        | 28.6M/196M [00:02<00:07, 23.3Mbytes/s]     16%|█▌        | 31.6M/196M [00:02<00:06, 24.5Mbytes/s]     17%|█▋        | 34.1M/196M [00:02<00:06, 24.1Mbytes/s]     19%|█▊        | 36.5M/196M [00:02<00:06, 23.8Mbytes/s]     20%|██        | 39.4M/196M [00:02<00:06, 24.9Mbytes/s]     21%|██▏       | 41.9M/196M [00:03<00:06, 24.3Mbytes/s]     23%|██▎       | 44.4M/196M [00:03<00:06, 24.1Mbytes/s]     24%|██▍       | 47.1M/196M [00:03<00:05, 24.8Mbytes/s]     25%|██▌       | 49.6M/196M [00:03<00:06, 24.3Mbytes/s]     27%|██▋       | 52.1M/196M [00:03<00:06, 23.9Mbytes/s]     28%|██▊       | 54.9M/196M [00:03<00:05, 24.9Mbytes/s]     29%|██▉       | 57.4M/196M [00:03<00:05, 24.4Mbytes/s]     31%|███       | 59.8M/196M [00:03<00:05, 24.1Mbytes/s]     32%|███▏      | 62.6M/196M [00:03<00:05, 24.9Mbytes/s]     33%|███▎      | 65.1M/196M [00:04<00:05, 24.4Mbytes/s]     35%|███▍      | 67.6M/196M [00:04<00:05, 24.1Mbytes/s]     36%|███▌      | 70.3M/196M [00:04<00:05, 24.2Mbytes/s]     37%|███▋      | 72.9M/196M [00:04<00:05, 23.9Mbytes/s]     39%|███▊      | 75.5M/196M [00:04<00:05, 23.5Mbytes/s]     40%|████      | 78.5M/196M [00:04<00:04, 23.5Mbytes/s]     42%|████▏     | 81.5M/196M [00:04<00:04, 25.0Mbytes/s]     43%|████▎     | 84.0M/196M [00:04<00:04, 24.5Mbytes/s]     44%|████▍     | 86.5M/196M [00:04<00:04, 23.9Mbytes/s]     46%|████▌     | 89.1M/196M [00:05<00:04, 24.3Mbytes/s]     47%|████▋     | 91.7M/196M [00:05<00:04, 24.3Mbytes/s]     48%|████▊     | 94.1M/196M [00:05<00:04, 24.0Mbytes/s]     49%|████▉     | 96.8M/196M [00:05<00:04, 24.3Mbytes/s]     51%|█████     | 99.3M/196M [00:05<00:03, 24.6Mbytes/s]     52%|█████▏    | 102M/196M [00:05<00:04, 21.4Mbytes/s]      53%|█████▎    | 104M/196M [00:05<00:04, 19.5Mbytes/s]     55%|█████▌    | 108M/196M [00:05<00:04, 21.3Mbytes/s]     57%|█████▋    | 112M/196M [00:06<00:03, 22.3Mbytes/s]     59%|█████▉    | 116M/196M [00:06<00:03, 22.9Mbytes/s]     61%|██████    | 120M/196M [00:06<00:03, 23.4Mbytes/s]     63%|██████▎   | 123M/196M [00:06<00:03, 22.2Mbytes/s]     64%|██████▍   | 126M/196M [00:06<00:03, 19.7Mbytes/s]     65%|██████▌   | 128M/196M [00:06<00:03, 17.8Mbytes/s]     67%|██████▋   | 131M/196M [00:07<00:03, 19.3Mbytes/s]     69%|██████▉   | 135M/196M [00:07<00:02, 20.9Mbytes/s]     71%|███████   | 139M/196M [00:07<00:02, 22.0Mbytes/s]     73%|███████▎  | 143M/196M [00:07<00:02, 22.7Mbytes/s]     75%|███████▌  | 147M/196M [00:07<00:02, 23.1Mbytes/s]     77%|███████▋  | 151M/196M [00:07<00:01, 23.5Mbytes/s]     79%|███████▉  | 154M/196M [00:07<00:01, 23.8Mbytes/s]     81%|████████  | 158M/196M [00:08<00:01, 24.0Mbytes/s]     83%|████████▎ | 162M/196M [00:08<00:01, 24.1Mbytes/s]     85%|████████▍ | 166M/196M [00:08<00:01, 24.2Mbytes/s]     87%|████████▋ | 170M/196M [00:08<00:01, 24.4Mbytes/s]     89%|████████▉ | 174M/196M [00:08<00:00, 24.4Mbytes/s]     91%|█████████ | 178M/196M [00:08<00:00, 24.4Mbytes/s]     93%|█████████▎| 182M/196M [00:09<00:00, 24.4Mbytes/s]     95%|█████████▍| 186M/196M [00:09<00:00, 24.3Mbytes/s]     97%|█████████▋| 189M/196M [00:09<00:00, 24.4Mbytes/s]     99%|█████████▉| 193M/196M [00:09<00:00, 24.5Mbytes/s]    100%|██████████| 196M/196M [00:09<00:00, 20.4Mbytes/s]




.. GENERATED FROM PYTHON SOURCE LINES 40-45

Here, without loss of generality, we use a single-slice 2D phantom.
A 3D phantom can be generated by setting ``ndim=3``.

The ``(M0, T1, T2, T2*, Chi)`` properties of the phantom
can be direcly accessed as:

.. GENERATED FROM PYTHON SOURCE LINES 45-71

.. code-block:: Python


    fig1, ax1 = plt.subplots(1, 5)

    im0 = ax1[0].imshow(phantom.M0, cmap="gray", vmin=0)
    ax1[0].axis("off"), ax1[0].set_title("M0 [a.u.]")
    fig1.colorbar(im0, ax=ax1[0], fraction=0.046, pad=0.04)

    im1 = ax1[1].imshow(phantom.T1, cmap="magma", vmin=0)
    ax1[1].axis("off"), ax1[1].set_title("T1 [ms]")
    fig1.colorbar(im1, ax=ax1[1], fraction=0.046, pad=0.04)

    im2 = ax1[2].imshow(phantom.T2, cmap="viridis", vmin=0, vmax=250)
    ax1[2].axis("off"), ax1[2].set_title("T2 [ms]")
    fig1.colorbar(im2, ax=ax1[2], fraction=0.046, pad=0.04)

    im3 = ax1[3].imshow(phantom.T2s, cmap="viridis", vmin=0, vmax=250)
    ax1[3].axis("off"), ax1[3].set_title("T2* [ms]")
    fig1.colorbar(im3, ax=ax1[3], fraction=0.046, pad=0.04)

    im4 = ax1[4].imshow(phantom.Chi, cmap="gray")
    ax1[4].axis("off"), ax1[4].set_title("Chi")
    fig1.colorbar(im4, ax=ax1[4], fraction=0.046, pad=0.04)

    plt.tight_layout()
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_001.png
   :alt: M0 [a.u.], T1 [ms], T2 [ms], T2* [ms], Chi
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 72-74

If required, the ``properties`` dictionary can be directly accessed as ``phantom.properties``,
e.g., to be passed as ``**kwargs`` to a simulator routine.

.. GENERATED FROM PYTHON SOURCE LINES 76-84

By default, OSF phantoms are interpolated
to 1.0625 mm isotropic resolution with a 256 isotropic matrix (272 mm iso FOV).

These can be adjusted using `shape` and `output_res` model:

1. ``shape`` will control the matrix size without affecting the resolution.
2. ``output_res`` will adjust the spatial resolution keeping the same (i.e., 200 iso) matrix


.. GENERATED FROM PYTHON SOURCE LINES 85-114

.. code-block:: Python


    phantom = osf_phantom(ndim=2, subject=1)
    phantom_mtx = osf_phantom(ndim=2, subject=1, shape=200)  # can also be shape=(ny, nx)
    phantom_res = osf_phantom(
        ndim=2, subject=1, output_res=2.0
    )  # can also be output_res=(dy, dx)
    phantom_mtx_res = osf_phantom(ndim=2, subject=1, shape=200, output_res=2.0)

    print(phantom)
    print(phantom_mtx)
    print(phantom_res)
    print(phantom_mtx_res)

    fig2, ax2 = plt.subplots(2, 2)
    ax2[0, 0].imshow(phantom.T1, cmap="magma"), ax2[0, 0].axis("off"), ax2[0, 0].set_title(
        "shape 256, res=1.0625, fov=272mm"
    )
    ax2[0, 1].imshow(phantom_mtx.T1, cmap="magma"), ax2[0, 1].axis("off"), ax2[
        0, 1
    ].set_title("shape 200, res=1.36mm, fov=272mm")
    ax2[1, 0].imshow(phantom_res.T1, cmap="magma"), ax2[1, 0].axis("off"), ax2[
        1, 0
    ].set_title("shape 200, res=2.0mm, fov=400mm")
    ax2[1, 1].imshow(phantom_mtx_res.T1, cmap="magma"), ax2[1, 1].axis("off"), ax2[
        1, 1
    ].set_title("shape 256, res=2.0mm, fov=512mm")
    plt.show()





.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_002.png
   :alt: shape 256, res=1.0625, fov=272mm, shape 200, res=1.36mm, fov=272mm, shape 200, res=2.0mm, fov=400mm, shape 256, res=2.0mm, fov=512mm
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dense OSF phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (256, 256)

    Dense OSF phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)

    Dense OSF phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (256, 256)

    Dense OSF phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)





.. GENERATED FROM PYTHON SOURCE LINES 115-119

The physical parameter of each tissue class are reported by
default for a field strength of 3.0 T.

This can be changed via the ``B0`` argument:

.. GENERATED FROM PYTHON SOURCE LINES 120-149

.. code-block:: Python


    # B0 strengths
    B0 = [0.55, 1.5, 3.0, 7.0, 11.7, 13.3]  # field strengths in [T]

    # Generate phantoms with different field strengths
    phantomB0 = [osf_phantom(ndim=2, subject=1, B0=strength) for strength in B0]

    # Display
    T1 = np.concatenate([phantom.T1 for phantom in phantomB0], axis=1)
    T2 = np.concatenate([phantom.T2 for phantom in phantomB0], axis=1)
    T2s = np.concatenate([phantom.T2s for phantom in phantomB0], axis=1)

    fig5, ax5 = plt.subplots(3, 1)

    im1 = ax5[0].imshow(T1, cmap="magma", vmin=0, vmax=5000)
    ax5[0].axis("off"), ax5[0].set_title("T1 [ms]")
    fig5.colorbar(im1, ax=ax5[0], fraction=0.046, pad=0.04)

    im2 = ax5[1].imshow(T2, cmap="viridis", vmin=0, vmax=250)
    ax5[1].axis("off"), ax5[1].set_title("T2 [ms]")
    fig5.colorbar(im2, ax=ax5[1], fraction=0.046, pad=0.04)

    im3 = ax5[2].imshow(T2s, cmap="viridis", vmin=0, vmax=250)
    ax5[2].axis("off"), ax5[2].set_title("T2* [ms]")
    fig5.colorbar(im3, ax=ax5[2], fraction=0.046, pad=0.04)

    plt.tight_layout()
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_003.png
   :alt: T1 [ms], T2 [ms], T2* [ms]
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_cbs_neuro_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 150-175

In this case, T1 and T2* are extrapolated from their 3.0 T values.

Caching mechanism
=================

To reduce loading times, ``mrtwin`` implements a caching mechanism.

If ``cache`` argument is set to ``True`` (default behaviour), each phantom
segmentation (identified by the number of spatial dimensions, matrix shape and resolution)
is saved on the disk in ``npy`` format.

The path is selected according to the following hierachy (inspired by ``brainweb-dl``):

1. User-specific argument (``cache_dir``)
2. ``MRTWIN_DIR`` environment variable
3. ``~/.cache/mrtwin`` folder


Disabling SSL verification (not recommended)
============================================

If you encounter some issue in downloading, SSL verification
can be disabled by setting ``verify`` to ``False`` (default: ``True``).
It is advised however to solve the problem on your machine side
(updating the certificate).


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (2 minutes 13.641 seconds)


.. _sphx_glr_download_generated_autoexamples_01.Phantoms_example_cbs_neuro.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/infn-mri/mrtwin/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/01.Phantoms/example_cbs_neuro.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_cbs_neuro.ipynb <example_cbs_neuro.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_cbs_neuro.py <example_cbs_neuro.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_cbs_neuro.zip <example_cbs_neuro.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_


.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "generated/autoexamples/01.Phantoms/example_brainweb.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_generated_autoexamples_01.Phantoms_example_brainweb.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_generated_autoexamples_01.Phantoms_example_brainweb.py:


================
Brainweb Phantom
================

Example of Brainweb phantom creation.

This examples show how to generate numerical phantoms based on the Brainweb
dataset.

.. GENERATED FROM PYTHON SOURCE LINES 12-18

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    from mrtwin import brainweb_phantom








.. GENERATED FROM PYTHON SOURCE LINES 19-26

Basic Usage
===========
The Brainweb database consists of a set of 20 normal brains
(ids equal to ``[4, 5, 6, 18, 20, 38, 41-54]``) at a nominal 0.5 mm isotropic
resolution and a shape of ``(nz, ny, nx) = (362, 434, 362)``.

A digital Brainweb phantom can be created as:

.. GENERATED FROM PYTHON SOURCE LINES 26-30

.. code-block:: Python


    phantom2D = brainweb_phantom(ndim=2, subject=4, segtype="fuzzy")  # 2D phantom
    phantom3D = brainweb_phantom(ndim=3, subject=4, segtype="fuzzy")  # 3D phantom





.. rst-class:: sphx-glr-script-out

 .. code-block:: none



    Downloading subject04_csf: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 0.00B [00:00, ?B/s]

    Downloading subject04_bck: 0.00B [00:00, ?B/s]

    Downloading subject04_wht: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 1.00kB [00:03, 269B/s]

    Downloading subject04_gry: 33.0kB [00:03, 11.9kB/s]

    Downloading subject04_gry: 145kB [00:04, 65.4kB/s] 

    Downloading subject04_bck: 1.00kB [00:04, 247B/s]

    Downloading subject04_gry: 264kB [00:04, 135kB/s] 

    Downloading subject04_bck: 33.0kB [00:04, 11.0kB/s]

    Downloading subject04_wht: 1.00kB [00:04, 238B/s]

    Downloading subject04_csf: 1.00kB [00:04, 233B/s]

    Downloading subject04_gry: 337kB [00:04, 178kB/s]

    Downloading subject04_bck: 145kB [00:04, 60.9kB/s] 

    Downloading subject04_wht: 33.0kB [00:04, 10.6kB/s]

    Downloading subject04_csf: 33.0kB [00:04, 10.4kB/s]

    Downloading subject04_gry: 488kB [00:04, 303kB/s]

    Downloading subject04_bck: 273kB [00:04, 134kB/s] 

    Downloading subject04_wht: 136kB [00:04, 54.7kB/s] 

    Downloading subject04_csf: 153kB [00:04, 61.2kB/s] 

    Downloading subject04_gry: 585kB [00:04, 366kB/s]

    Downloading subject04_bck: 417kB [00:04, 227kB/s]

    Downloading subject04_wht: 241kB [00:04, 110kB/s] 

    Downloading subject04_csf: 321kB [00:04, 152kB/s] 

    Downloading subject04_gry: 689kB [00:04, 435kB/s]

    Downloading subject04_bck: 577kB [00:04, 349kB/s]

    Downloading subject04_wht: 361kB [00:04, 187kB/s]

    Downloading subject04_csf: 505kB [00:04, 271kB/s]

    Downloading subject04_gry: 793kB [00:04, 504kB/s]

    Downloading subject04_bck: 721kB [00:04, 454kB/s]

    Downloading subject04_wht: 489kB [00:05, 279kB/s]

    Downloading subject04_csf: 713kB [00:05, 429kB/s]

    Downloading subject04_bck: 814kB [00:05, 517kB/s]

    Downloading subject04_gry: 905kB [00:05, 573kB/s]

    Downloading subject04_wht: 633kB [00:05, 394kB/s]

    Downloading subject04_csf: 937kB [00:05, 614kB/s]

    Downloading subject04_gry: 1.00MB [00:05, 636kB/s]

    Downloading subject04_bck: 905kB [00:05, 540kB/s]

    Downloading subject04_wht: 793kB [00:05, 527kB/s]

    Downloading subject04_csf: 1.16MB [00:05, 832kB/s]

    Downloading subject04_gry: 1.11MB [00:05, 686kB/s]

    Downloading subject04_bck: 993kB [00:05, 541kB/s]

    Downloading subject04_wht: 968kB [00:05, 674kB/s]

    Downloading subject04_csf: 1.42MB [00:05, 1.07MB/s]

    Downloading subject04_gry: 1.23MB [00:05, 747kB/s]

    Downloading subject04_wht: 1.13MB [00:05, 829kB/s]

    Downloading subject04_csf: 1.72MB [00:05, 1.34MB/s]

    Downloading subject04_bck: 1.05MB [00:05, 501kB/s]

    Downloading subject04_gry: 1.35MB [00:05, 778kB/s]

    Downloading subject04_csf: 2.04MB [00:05, 1.66MB/s]

    Downloading subject04_wht: 1.34MB [00:05, 987kB/s]

    Downloading subject04_bck: 1.13MB [00:05, 518kB/s]

    Downloading subject04_gry: 1.48MB [00:05, 812kB/s]

    Downloading subject04_csf: 2.40MB [00:05, 1.95MB/s]

    Downloading subject04_wht: 1.56MB [00:05, 1.16MB/s]

    Downloading subject04_gry: 1.59MB [00:05, 832kB/s]

    Downloading subject04_csf: 2.79MB [00:06, 2.23MB/s]

    Downloading subject04_wht: 1.81MB [00:06, 1.39MB/s]

    Downloading subject04_csf: 3.22MB [00:06, 2.73MB/s]

    Downloading subject04_gry: 1.73MB [00:06, 865kB/s]

    Downloading subject04_wht: 2.01MB [00:06, 1.53MB/s]

                                                      

    Downloading subject04_csf: 3.52MB [00:06, 2.66MB/s]

    Downloading subject04_gry: 1.85MB [00:06, 887kB/s]

    Downloading subject04_wht: 2.24MB [00:06, 1.60MB/s]

    Downloading subject04_csf: 3.95MB [00:06, 2.89MB/s]

    Downloading subject04_gry: 1.98MB [00:06, 949kB/s]

    Downloading subject04_wht: 2.56MB [00:06, 1.82MB/s]

    Downloading subject04_csf: 4.31MB [00:06, 3.06MB/s]

    Downloading subject04_wht: 2.91MB [00:06, 2.14MB/s]

    Downloading subject04_gry: 2.11MB [00:06, 902kB/s]

    Downloading subject04_csf: 4.62MB [00:06, 2.96MB/s]

    Downloading subject04_wht: 3.27MB [00:06, 2.51MB/s]

    Downloading subject04_gry: 2.24MB [00:06, 922kB/s]

    Downloading subject04_csf: 4.91MB [00:06, 2.96MB/s]

    Downloading subject04_wht: 3.52MB [00:06, 2.33MB/s]

    Downloading subject04_csf: 5.21MB [00:06, 2.82MB/s]

    Downloading subject04_gry: 2.38MB [00:06, 930kB/s]

    Downloading subject04_wht: 3.96MB [00:06, 2.75MB/s]

    Downloading subject04_fat: 0.00B [00:00, ?B/s]

    Downloading subject04_csf: 5.48MB [00:06, 2.64MB/s]

    Downloading subject04_gry: 2.51MB [00:06, 947kB/s]

    Downloading subject04_wht: 4.25MB [00:06, 2.82MB/s]

    Downloading subject04_wht: 4.63MB [00:07, 3.11MB/s]

    Downloading subject04_gry: 2.64MB [00:07, 984kB/s]

    Downloading subject04_csf: 5.74MB [00:07, 2.16MB/s]

    Downloading subject04_wht: 4.93MB [00:07, 2.99MB/s]

    Downloading subject04_csf: 5.96MB [00:07, 2.02MB/s]

    Downloading subject04_gry: 2.76MB [00:07, 893kB/s]

    Downloading subject04_wht: 5.22MB [00:07, 2.62MB/s]

    Downloading subject04_csf: 6.16MB [00:07, 1.94MB/s]

    Downloading subject04_gry: 2.88MB [00:07, 921kB/s]

    Downloading subject04_csf: 6.35MB [00:07, 1.90MB/s]

    Downloading subject04_wht: 5.49MB [00:07, 2.27MB/s]

    Downloading subject04_gry: 2.98MB [00:07, 866kB/s]

    Downloading subject04_csf: 6.54MB [00:07, 1.81MB/s]

    Downloading subject04_wht: 5.77MB [00:07, 2.42MB/s]

    Downloading subject04_fat: 1.00kB [00:00, 1.39kB/s]

    Downloading subject04_gry: 3.09MB [00:07, 862kB/s]

    Downloading subject04_wht: 6.03MB [00:07, 2.50MB/s]

    Downloading subject04_csf: 6.71MB [00:07, 1.74MB/s]

    Downloading subject04_fat: 33.0kB [00:00, 51.9kB/s]

    Downloading subject04_gry: 3.19MB [00:07, 905kB/s]

    Downloading subject04_csf: 6.92MB [00:07, 1.85MB/s]

    Downloading subject04_wht: 6.28MB [00:07, 2.36MB/s]

    Downloading subject04_fat: 144kB [00:00, 235kB/s]  

    Downloading subject04_gry: 3.28MB [00:07, 836kB/s]

    Downloading subject04_csf: 7.11MB [00:07, 1.88MB/s]

    Downloading subject04_wht: 6.52MB [00:07, 2.37MB/s]

    Downloading subject04_fat: 272kB [00:01, 422kB/s]

    Downloading subject04_gry: 3.38MB [00:08, 843kB/s]

    Downloading subject04_csf: 7.30MB [00:08, 1.89MB/s]

    Downloading subject04_wht: 6.75MB [00:08, 2.27MB/s]

    Downloading subject04_gry: 3.48MB [00:08, 895kB/s]

    Downloading subject04_csf: 7.52MB [00:08, 1.98MB/s]

    Downloading subject04_fat: 409kB [00:01, 590kB/s]

    Downloading subject04_wht: 6.97MB [00:08, 2.20MB/s]

    Downloading subject04_csf: 7.74MB [00:08, 2.06MB/s]

    Downloading subject04_gry: 3.56MB [00:08, 833kB/s]

    Downloading subject04_fat: 561kB [00:01, 752kB/s]

    Downloading subject04_wht: 7.18MB [00:08, 1.95MB/s]

    Downloading subject04_csf: 7.93MB [00:08, 1.90MB/s]

    Downloading subject04_gry: 3.69MB [00:08, 887kB/s]

    Downloading subject04_fat: 721kB [00:01, 892kB/s]

    Downloading subject04_wht: 7.38MB [00:08, 1.91MB/s]

    Downloading subject04_gry: 3.81MB [00:08, 973kB/s]

    Downloading subject04_fat: 865kB [00:01, 952kB/s]

    Downloading subject04_csf: 8.12MB [00:08, 1.58MB/s]

    Downloading subject04_wht: 7.56MB [00:08, 1.84MB/s]

    Downloading subject04_gry: 3.90MB [00:08, 896kB/s]

    Downloading subject04_csf: 8.28MB [00:08, 1.56MB/s]

    Downloading subject04_fat: 970kB [00:01, 923kB/s]

    Downloading subject04_wht: 7.74MB [00:08, 1.76MB/s]

    Downloading subject04_gry: 4.01MB [00:08, 909kB/s]

    Downloading subject04_csf: 8.47MB [00:08, 1.66MB/s]

    Downloading subject04_wht: 7.91MB [00:08, 1.66MB/s]

    Downloading subject04_gry: 4.13MB [00:08, 985kB/s]

    Downloading subject04_fat: 1.04MB [00:01, 758kB/s]

    Downloading subject04_csf: 8.69MB [00:08, 1.79MB/s]

    Downloading subject04_wht: 8.08MB [00:08, 1.68MB/s]

    Downloading subject04_gry: 4.22MB [00:08, 955kB/s]

    Downloading subject04_csf: 8.88MB [00:09, 1.81MB/s]

    Downloading subject04_fat: 1.13MB [00:02, 731kB/s]

    Downloading subject04_wht: 8.24MB [00:09, 1.66MB/s]

    Downloading subject04_gry: 4.34MB [00:09, 1.02MB/s]

    Downloading subject04_csf: 9.05MB [00:09, 1.71MB/s]

    Downloading subject04_wht: 8.41MB [00:09, 1.65MB/s]

    Downloading subject04_fat: 1.20MB [00:02, 697kB/s]

    Downloading subject04_gry: 4.44MB [00:09, 974kB/s] 

    Downloading subject04_wht: 8.59MB [00:09, 1.67MB/s]

    Downloading subject04_fat: 1.30MB [00:02, 721kB/s]

    Downloading subject04_gry: 4.53MB [00:09, 875kB/s]

    Downloading subject04_wht: 8.77MB [00:09, 1.69MB/s]

    Downloading subject04_fat: 1.38MB [00:02, 699kB/s]

    Downloading subject04_csf: 9.22MB [00:09, 1.07MB/s]

    Downloading subject04_wht: 8.94MB [00:09, 1.71MB/s]

    Downloading subject04_gry: 4.66MB [00:09, 882kB/s]

    Downloading subject04_fat: 1.45MB [00:02, 672kB/s]

    Downloading subject04_wht: 9.17MB [00:09, 1.92MB/s]

    Downloading subject04_gry: 4.76MB [00:09, 837kB/s]

    Downloading subject04_fat: 1.52MB [00:02, 651kB/s]

    Downloading subject04_wht: 9.47MB [00:09, 2.21MB/s]

    Downloading subject04_gry: 4.86MB [00:09, 808kB/s]

    Downloading subject04_wht: 9.74MB [00:09, 2.32MB/s]

                                                       

    Downloading subject04_wht: 10.0MB [00:09, 2.54MB/s]

    Downloading subject04_gry: 4.96MB [00:09, 796kB/s]

    Downloading subject04_wht: 10.3MB [00:09, 2.64MB/s]

    Downloading subject04_gry: 5.06MB [00:10, 787kB/s]

                                                      

    Downloading subject04_wht: 10.7MB [00:10, 2.99MB/s]

    Downloading subject04_gry: 5.15MB [00:10, 810kB/s]

    Downloading subject04_gry: 5.23MB [00:10, 786kB/s]

    Downloading subject04_gry: 5.31MB [00:10, 812kB/s]

    Downloading subject04_gry: 5.40MB [00:10, 804kB/s]

    Downloading subject04_gry: 5.49MB [00:10, 851kB/s]

    Downloading subject04_gry: 5.58MB [00:10, 820kB/s]

                                                       

    Downloading subject04_gry: 5.66MB [00:10, 852kB/s]

    Downloading subject04_m-s: 0.00B [00:00, ?B/s]

    Downloading subject04_mus: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 5.75MB [00:10, 837kB/s]

    Downloading subject04_gry: 5.85MB [00:10, 893kB/s]

    Downloading subject04_gry: 5.94MB [00:11, 865kB/s]

    Downloading subject04_mus: 1.00kB [00:00, 2.59kB/s]

    Downloading subject04_gry: 6.04MB [00:11, 917kB/s]

    Downloading subject04_m-s: 1.00kB [00:00, 2.12kB/s]

    Downloading subject04_gry: 6.13MB [00:11, 896kB/s]

    Downloading subject04_mus: 33.0kB [00:00, 79.3kB/s]

    Downloading subject04_skl: 0.00B [00:00, ?B/s]

    Downloading subject04_m-s: 33.0kB [00:00, 69.6kB/s]

    Downloading subject04_mus: 145kB [00:00, 333kB/s]  

    Downloading subject04_gry: 6.23MB [00:11, 777kB/s]

    Downloading subject04_m-s: 120kB [00:00, 234kB/s]  

    Downloading subject04_mus: 216kB [00:00, 436kB/s]

    Downloading subject04_gry: 6.36MB [00:11, 879kB/s]

    Downloading subject04_mus: 344kB [00:00, 639kB/s]

    Downloading subject04_m-s: 215kB [00:00, 367kB/s]

    Downloading subject04_gry: 6.45MB [00:11, 886kB/s]

    Downloading subject04_mus: 425kB [00:00, 689kB/s]

    Downloading subject04_skl: 1.00kB [00:00, 2.43kB/s]

    Downloading subject04_m-s: 320kB [00:01, 481kB/s]

    Downloading subject04_gry: 6.53MB [00:11, 812kB/s]

    Downloading subject04_mus: 577kB [00:01, 823kB/s]

    Downloading subject04_skl: 33.0kB [00:00, 77.4kB/s]

    Downloading subject04_gry: 6.61MB [00:11, 775kB/s]

    Downloading subject04_m-s: 433kB [00:01, 578kB/s]

    Downloading subject04_skl: 113kB [00:00, 239kB/s]  

    Downloading subject04_gry: 6.71MB [00:12, 843kB/s]

    Downloading subject04_mus: 753kB [00:01, 964kB/s]

    Downloading subject04_m-s: 560kB [00:01, 676kB/s]

    Downloading subject04_gry: 6.79MB [00:12, 775kB/s]

    Downloading subject04_skl: 201kB [00:00, 367kB/s]

    Downloading subject04_mus: 945kB [00:01, 1.09MB/s]

    Downloading subject04_m-s: 697kB [00:01, 766kB/s]

    Downloading subject04_gry: 6.88MB [00:12, 768kB/s]

    Downloading subject04_skl: 288kB [00:00, 454kB/s]

    Downloading subject04_mus: 1.13MB [00:01, 1.21MB/s]

    Downloading subject04_m-s: 849kB [00:01, 861kB/s]

    Downloading subject04_gry: 6.99MB [00:12, 867kB/s]

    Downloading subject04_skl: 392kB [00:01, 550kB/s]

    Downloading subject04_mus: 1.35MB [00:01, 1.34MB/s]

    Downloading subject04_gry: 7.08MB [00:12, 821kB/s]

    Downloading subject04_m-s: 0.99MB [00:01, 960kB/s]

    Downloading subject04_skl: 513kB [00:01, 656kB/s]

    Downloading subject04_mus: 1.60MB [00:01, 1.48MB/s]

    Downloading subject04_gry: 7.19MB [00:12, 835kB/s]

    Downloading subject04_m-s: 1.17MB [00:01, 1.07MB/s]

    Downloading subject04_skl: 633kB [00:01, 727kB/s]

    Downloading subject04_mus: 1.88MB [00:01, 1.73MB/s]

    Downloading subject04_gry: 7.31MB [00:12, 936kB/s]

    Downloading subject04_m-s: 1.34MB [00:02, 1.09MB/s]

    Downloading subject04_mus: 2.04MB [00:02, 1.74MB/s]

    Downloading subject04_skl: 776kB [00:01, 829kB/s]

    Downloading subject04_gry: 7.40MB [00:12, 863kB/s]

    Downloading subject04_m-s: 1.53MB [00:02, 1.21MB/s]

    Downloading subject04_mus: 2.34MB [00:02, 1.88MB/s]

    Downloading subject04_skl: 928kB [00:01, 919kB/s]

    Downloading subject04_gry: 7.50MB [00:13, 866kB/s]

    Downloading subject04_mus: 2.69MB [00:02, 2.21MB/s]

    Downloading subject04_m-s: 1.67MB [00:02, 1.16MB/s]

    Downloading subject04_skl: 1.07MB [00:01, 1.02MB/s]

    Downloading subject04_gry: 7.63MB [00:13, 883kB/s]

    Downloading subject04_mus: 2.90MB [00:02, 2.21MB/s]

    Downloading subject04_m-s: 1.83MB [00:02, 1.15MB/s]

    Downloading subject04_gry: 7.75MB [00:13, 989kB/s]

    Downloading subject04_skl: 1.25MB [00:01, 1.13MB/s]

    Downloading subject04_mus: 3.12MB [00:02, 2.16MB/s]

    Downloading subject04_skl: 1.41MB [00:02, 1.22MB/s]

    Downloading subject04_m-s: 1.99MB [00:02, 1.15MB/s]

    Downloading subject04_gry: 7.85MB [00:13, 896kB/s]

    Downloading subject04_mus: 3.32MB [00:02, 2.12MB/s]

    Downloading subject04_skl: 1.58MB [00:02, 1.36MB/s]

    Downloading subject04_gry: 7.94MB [00:13, 868kB/s]

    Downloading subject04_m-s: 2.15MB [00:02, 1.16MB/s]

    Downloading subject04_mus: 3.53MB [00:02, 1.95MB/s]

    Downloading subject04_skl: 1.71MB [00:02, 1.32MB/s]

    Downloading subject04_m-s: 2.31MB [00:02, 1.23MB/s]

    Downloading subject04_gry: 8.02MB [00:13, 791kB/s]

    Downloading subject04_mus: 3.71MB [00:02, 1.85MB/s]

    Downloading subject04_skl: 1.84MB [00:02, 1.33MB/s]

    Downloading subject04_m-s: 2.44MB [00:03, 1.25MB/s]

    Downloading subject04_mus: 3.89MB [00:03, 1.76MB/s]

    Downloading subject04_gry: 8.12MB [00:13, 777kB/s]

    Downloading subject04_skl: 1.97MB [00:02, 1.32MB/s]

    Downloading subject04_m-s: 2.58MB [00:03, 1.26MB/s]

    Downloading subject04_mus: 4.09MB [00:03, 1.84MB/s]

    Downloading subject04_gry: 8.20MB [00:13, 780kB/s]

    Downloading subject04_skl: 2.13MB [00:02, 1.34MB/s]

    Downloading subject04_m-s: 2.70MB [00:03, 1.27MB/s]

    Downloading subject04_mus: 4.30MB [00:03, 1.90MB/s]

    Downloading subject04_gry: 8.28MB [00:14, 749kB/s]

    Downloading subject04_skl: 2.28MB [00:02, 1.39MB/s]

    Downloading subject04_m-s: 2.85MB [00:03, 1.30MB/s]

    Downloading subject04_mus: 4.52MB [00:03, 1.99MB/s]

    Downloading subject04_gry: 8.36MB [00:14, 774kB/s]

    Downloading subject04_skl: 2.42MB [00:02, 1.29MB/s]

    Downloading subject04_m-s: 2.99MB [00:03, 1.32MB/s]

    Downloading subject04_mus: 4.77MB [00:03, 2.14MB/s]

    Downloading subject04_gry: 8.43MB [00:14, 746kB/s]

    Downloading subject04_m-s: 3.13MB [00:03, 1.33MB/s]

    Downloading subject04_mus: 4.97MB [00:03, 2.06MB/s]

    Downloading subject04_gry: 8.52MB [00:14, 729kB/s]

    Downloading subject04_skl: 2.54MB [00:03, 966kB/s] 

    Downloading subject04_m-s: 3.27MB [00:03, 1.35MB/s]

    Downloading subject04_mus: 5.17MB [00:03, 1.95MB/s]

    Downloading subject04_gry: 8.61MB [00:14, 773kB/s]

    Downloading subject04_m-s: 3.42MB [00:03, 1.37MB/s]

    Downloading subject04_mus: 5.39MB [00:03, 2.03MB/s]

    Downloading subject04_gry: 8.69MB [00:14, 754kB/s]

    Downloading subject04_m-s: 3.56MB [00:03, 1.40MB/s]

    Downloading subject04_mus: 5.69MB [00:03, 2.30MB/s]

    Downloading subject04_gry: 8.77MB [00:14, 793kB/s]

    Downloading subject04_m-s: 3.72MB [00:03, 1.41MB/s]

    Downloading subject04_mus: 5.92MB [00:03, 2.32MB/s]

                                                      

    Downloading subject04_gry: 8.85MB [00:14, 770kB/s]

    Downloading subject04_m-s: 3.86MB [00:04, 1.42MB/s]

    Downloading subject04_mus: 6.15MB [00:04, 2.16MB/s]

    Downloading subject04_gry: 8.94MB [00:14, 802kB/s]

    Downloading subject04_m-s: 4.00MB [00:04, 1.25MB/s]

    Downloading subject04_gry: 9.02MB [00:15, 800kB/s]

    Downloading subject04_m-s: 4.17MB [00:04, 1.37MB/s]

    Downloading subject04_gry: 9.12MB [00:15, 850kB/s]

    Downloading subject04_m-s: 4.31MB [00:04, 1.34MB/s]

    Downloading subject04_gry: 9.20MB [00:15, 830kB/s]

    Downloading subject04_m-s: 4.44MB [00:04, 1.22MB/s]

                                                       

    Downloading subject04_gry: 9.28MB [00:15, 702kB/s]

    Downloading subject04_m-s: 4.56MB [00:04, 1.13MB/s]

    Downloading subject04_ves: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 9.41MB [00:15, 796kB/s]

    Downloading subject04_m-s: 4.70MB [00:04, 1.16MB/s]

    Downloading subject04_gry: 9.49MB [00:15, 738kB/s]

    Downloading subject04_m-s: 4.83MB [00:04, 1.18MB/s]

    Downloading subject04_m-s: 4.94MB [00:05, 1.16MB/s]

    Downloading subject04_gry: 9.59MB [00:15, 723kB/s]

    Downloading subject04_fat2: 0.00B [00:00, ?B/s]

    Downloading subject04_m-s: 5.05MB [00:05, 1.16MB/s]

    Downloading subject04_gry: 9.69MB [00:15, 727kB/s]

    Downloading subject04_m-s: 5.18MB [00:05, 1.15MB/s]

    Downloading subject04_gry: 9.79MB [00:16, 732kB/s]

    Downloading subject04_m-s: 5.29MB [00:05, 1.16MB/s]

    Downloading subject04_ves: 1.00kB [00:00, 1.49kB/s]

    Downloading subject04_gry: 9.88MB [00:16, 779kB/s]

    Downloading subject04_m-s: 5.43MB [00:05, 1.19MB/s]

    Downloading subject04_ves: 33.0kB [00:00, 54.1kB/s]

    Downloading subject04_gry: 9.96MB [00:16, 768kB/s]

    Downloading subject04_m-s: 5.54MB [00:05, 1.19MB/s]

    Downloading subject04_gry: 10.0MB [00:16, 789kB/s]

    Downloading subject04_ves: 153kB [00:00, 256kB/s]  

    Downloading subject04_m-s: 5.68MB [00:05, 1.21MB/s]

    Downloading subject04_gry: 10.1MB [00:16, 779kB/s]

    Downloading subject04_m-s: 5.80MB [00:05, 1.21MB/s]

    Downloading subject04_ves: 289kB [00:01, 450kB/s]

    Downloading subject04_fat2: 1.00kB [00:00, 1.42kB/s]

    Downloading subject04_gry: 10.2MB [00:16, 799kB/s]

    Downloading subject04_m-s: 5.94MB [00:05, 1.24MB/s]

    Downloading subject04_ves: 433kB [00:01, 617kB/s]

    Downloading subject04_gry: 10.3MB [00:16, 789kB/s]

    Downloading subject04_fat2: 33.0kB [00:00, 52.2kB/s]

    Downloading subject04_m-s: 6.06MB [00:06, 1.23MB/s]

    Downloading subject04_ves: 601kB [00:01, 793kB/s]

    Downloading subject04_gry: 10.4MB [00:16, 846kB/s]

    Downloading subject04_m-s: 6.20MB [00:06, 1.25MB/s]

    Downloading subject04_fat2: 152kB [00:00, 247kB/s]  

    Downloading subject04_gry: 10.5MB [00:17, 833kB/s]

    Downloading subject04_ves: 785kB [00:01, 958kB/s]

    Downloading subject04_m-s: 6.32MB [00:06, 1.25MB/s]

    Downloading subject04_fat2: 280kB [00:01, 425kB/s]

    Downloading subject04_gry: 10.6MB [00:17, 847kB/s]

    Downloading subject04_m-s: 6.46MB [00:06, 1.28MB/s]

    Downloading subject04_ves: 985kB [00:01, 1.11MB/s]

    Downloading subject04_gry: 10.6MB [00:17, 834kB/s]

    Downloading subject04_fat2: 425kB [00:01, 598kB/s]

    Downloading subject04_m-s: 6.58MB [00:06, 1.28MB/s]

    Downloading subject04_ves: 1.18MB [00:01, 1.27MB/s]

    Downloading subject04_gry: 10.8MB [00:17, 889kB/s]

    Downloading subject04_m-s: 6.74MB [00:06, 1.31MB/s]

    Downloading subject04_fat2: 577kB [00:01, 739kB/s]

    Downloading subject04_gry: 10.8MB [00:17, 872kB/s]

    Downloading subject04_ves: 1.41MB [00:01, 1.41MB/s]

    Downloading subject04_m-s: 6.86MB [00:06, 1.31MB/s]

    Downloading subject04_fat2: 753kB [00:01, 900kB/s]

    Downloading subject04_ves: 1.56MB [00:02, 1.46MB/s]

    Downloading subject04_gry: 10.9MB [00:17, 886kB/s]

    Downloading subject04_fat2: 945kB [00:01, 1.05MB/s]

    Downloading subject04_gry: 11.0MB [00:17, 872kB/s]

    Downloading subject04_ves: 1.71MB [00:02, 1.43MB/s]

    Downloading subject04_m-s: 6.99MB [00:06, 1.00MB/s]

    Downloading subject04_ves: 1.85MB [00:02, 1.43MB/s]

    Downloading subject04_gry: 11.1MB [00:17, 906kB/s]

    Downloading subject04_fat2: 1.13MB [00:01, 1.20MB/s]

    Downloading subject04_ves: 1.99MB [00:02, 1.42MB/s]

    Downloading subject04_gry: 11.2MB [00:17, 891kB/s]

    Downloading subject04_fat2: 1.31MB [00:01, 1.35MB/s]

    Downloading subject04_gry: 11.3MB [00:17, 915kB/s]

    Downloading subject04_ves: 2.14MB [00:02, 1.41MB/s]

    Downloading subject04_fat2: 1.45MB [00:02, 1.36MB/s]

    Downloading subject04_gry: 11.4MB [00:18, 899kB/s]

    Downloading subject04_ves: 2.30MB [00:02, 1.44MB/s]

                                                       

    Downloading subject04_fat2: 1.61MB [00:02, 1.40MB/s]

    Downloading subject04_ves: 2.44MB [00:02, 1.43MB/s]

    Downloading subject04_gry: 11.5MB [00:18, 965kB/s]

    Downloading subject04_fat2: 1.75MB [00:02, 1.41MB/s]

    Downloading subject04_ves: 2.58MB [00:02, 1.43MB/s]

    Downloading subject04_gry: 11.6MB [00:18, 938kB/s]

    Downloading subject04_fat2: 1.89MB [00:02, 1.42MB/s]

    Downloading subject04_ves: 2.72MB [00:02, 1.44MB/s]

    Downloading subject04_gry: 11.7MB [00:18, 986kB/s]

    Downloading subject04_fat2: 2.03MB [00:02, 1.43MB/s]

    Downloading subject04_ves: 2.86MB [00:02, 1.42MB/s]

    Downloading subject04_gry: 11.8MB [00:18, 959kB/s]

    Downloading subject04_fat2: 2.17MB [00:02, 1.38MB/s]

    Downloading subject04_gry: 11.9MB [00:18, 1.02MB/s]

    Downloading subject04_fat2: 2.30MB [00:02, 1.34MB/s]

    Downloading subject04_gry: 12.0MB [00:18, 994kB/s] 

    Downloading subject04_fat2: 2.43MB [00:02, 1.34MB/s]

    Downloading subject04_dura: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 12.1MB [00:18, 1.04MB/s]

    Downloading subject04_fat2: 2.56MB [00:02, 1.33MB/s]

    Downloading subject04_gry: 12.2MB [00:18, 1.01MB/s]

    Downloading subject04_fat2: 2.74MB [00:02, 1.43MB/s]

                                                       

    Downloading subject04_gry: 12.4MB [00:19, 1.08MB/s]

    Downloading subject04_fat2: 2.88MB [00:03, 1.28MB/s]

    Downloading subject04_gry: 12.5MB [00:19, 1.05MB/s]

    Downloading subject04_dura: 1.00kB [00:00, 2.21kB/s]

    Downloading subject04_gry: 12.6MB [00:19, 1.11MB/s]

    Downloading subject04_gry: 12.7MB [00:19, 1.07MB/s]

    Downloading subject04_dura: 33.0kB [00:00, 71.5kB/s]

                                                        

    Downloading subject04_gry: 12.8MB [00:19, 1.13MB/s]

    Downloading subject04_dura: 152kB [00:00, 307kB/s]  

    Downloading subject04_mrw: 0.00B [00:00, ?B/s]

    Downloading subject04_gry: 12.9MB [00:19, 1.10MB/s]

    Downloading subject04_dura: 329kB [00:00, 631kB/s]

    Downloading subject04_gry: 13.1MB [00:19, 1.17MB/s]

    Downloading subject04_dura: 433kB [00:00, 735kB/s]

    Downloading subject04_gry: 13.2MB [00:19, 1.13MB/s]

    Downloading subject04_dura: 593kB [00:01, 874kB/s]

    Downloading subject04_gry: 13.3MB [00:19, 1.18MB/s]

    Downloading subject04_dura: 693kB [00:01, 889kB/s]

    Downloading subject04_gry: 13.4MB [00:20, 1.14MB/s]

    Downloading subject04_mrw: 1.00kB [00:00, 1.97kB/s]

    Downloading subject04_dura: 809kB [00:01, 955kB/s]

    Downloading subject04_gry: 13.6MB [00:20, 1.21MB/s]

    Downloading subject04_dura: 929kB [00:01, 1.01MB/s]

    Downloading subject04_mrw: 33.0kB [00:00, 65.9kB/s]

    Downloading subject04_gry: 13.7MB [00:20, 1.18MB/s]

    Downloading subject04_gry: 13.8MB [00:20, 1.25MB/s]

    Downloading subject04_mrw: 152kB [00:00, 290kB/s]  

    Downloading subject04_gry: 13.9MB [00:20, 1.21MB/s]

    Downloading subject04_mrw: 313kB [00:00, 563kB/s]

    Downloading subject04_gry: 14.1MB [00:20, 1.20MB/s]

    Downloading subject04_mrw: 481kB [00:01, 832kB/s]

                                                       

    Downloading subject04_mrw: 593kB [00:01, 880kB/s]

    Downloading subject04_mrw: 705kB [00:01, 942kB/s]

    Downloading subject04_mrw: 921kB [00:01, 1.22MB/s]

    Downloading subject04_mrw: 1.03MB [00:01, 1.26MB/s]

                                                       

    Downloading subject04_mrw: 1.27MB [00:01, 1.42MB/s]

    Downloading subject04_mrw: 1.51MB [00:01, 1.70MB/s]

    Downloading subject04_mrw: 1.69MB [00:01, 1.67MB/s]

    Downloading subject04_mrw: 1.91MB [00:01, 1.77MB/s]

    Downloading subject04_mrw: 2.08MB [00:02, 1.58MB/s]

    Downloading subject04_mrw: 2.24MB [00:02, 1.14MB/s]

                                                       



.. GENERATED FROM PYTHON SOURCE LINES 31-36

The phantoms here created are sparse, i.e., they consists of a
``(nclasses, *spatial_shape)`` shaped ``np.ndarray`` representing the
probabilistic maps of each tissue type (e.g., Gray Matter, White Matter, CSF)
and a list of ``(nclasses,)`` dictionaries each containing the ``(M0, T1, T2, T2*, Chi)``
values for each class:

.. GENERATED FROM PYTHON SOURCE LINES 36-64

.. code-block:: Python


    example2D = np.concatenate((phantom2D[3], phantom2D[2], phantom2D[1]), axis=0)

    example3Dax = np.concatenate(
        (phantom3D[3, 100], phantom3D[2, 100], phantom3D[1, 100]), axis=0
    )
    example3Dcor = np.concatenate(
        (phantom3D[3, ::-1, 100], phantom3D[2, ::-1, 100], phantom3D[1, ::-1, 100]), axis=0
    )
    example3Dsag = np.concatenate(
        (
            phantom3D[3, ::-1, :, 100],
            phantom3D[2, ::-1, :, 100],
            phantom3D[1, ::-1, :, 100],
        ),
        axis=0,
    )
    example3D = np.concatenate((example3Dax, example3Dcor, example3Dsag), axis=1)

    fig1, ax1 = plt.subplots(1, 2)
    ax1[0].imshow(example2D, cmap="gray"), ax1[0].axis("off"), ax1[0].set_title(
        "2D phantom"
    )
    ax1[1].imshow(example3D, cmap="gray"), ax1[1].axis("off"), ax1[1].set_title(
        "3D phantom"
    )
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_001.png
   :alt: 2D phantom, 3D phantom
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 65-67

The ``(M0, T1, T2, T2*, Chi)`` properties
can be direcly accessed as:

.. GENERATED FROM PYTHON SOURCE LINES 67-74

.. code-block:: Python


    _, _ = print("M0:", end="\t"), print(phantom2D.M0)  # same for phantom3D
    _, _ = print("T1 (ms):", end="\t"), print(phantom2D.T1)
    _, _ = print("T2 (ms):", end="\t"), print(phantom2D.T2)
    _, _ = print("T2* (ms):", end="\t"), print(phantom2D.T2s)
    _, _ = print("Chi:", end="\t"), print(phantom2D.Chi)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    M0:     [0.   1.   0.86 0.77 1.   1.   1.   1.   1.   1.   1.   1.  ]
    T1 (ms):        [   0.      4200.       998.1393   680.66815  342.50705 1050.
     1050.       350.      1549.5471   342.50705  700.       552.36127]
    T2 (ms):        [   0. 1990.  100.   80.   70.   50.   50.   15.  200.   70.  150.   50.]
    T2* (ms):       [  0.       243.06877   73.46702   62.067276  64.09466   42.323383
      42.323383  14.274805 116.12312   64.09466   97.293144  46.912655]
    Chi:    [ 4.00e-07 -9.00e-06 -9.00e-06 -9.00e-06  3.28e-06 -9.04e-06 -9.04e-06
     -8.44e-06 -9.00e-06  3.28e-06 -9.00e-06  3.28e-06]




.. GENERATED FROM PYTHON SOURCE LINES 75-77

If required, the ``properties`` dictionary
can be directly accessed as:

.. GENERATED FROM PYTHON SOURCE LINES 77-80

.. code-block:: Python


    print(phantom2D.properties)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    {'M0': array([0.  , 1.  , 0.86, 0.77, 1.  , 1.  , 1.  , 1.  , 1.  , 1.  , 1.  ,
           1.  ], dtype=float32), 'T1': array([   0.     , 4200.     ,  998.1393 ,  680.66815,  342.50705,
           1050.     , 1050.     ,  350.     , 1549.5471 ,  342.50705,
            700.     ,  552.36127], dtype=float32), 'T2': array([   0., 1990.,  100.,   80.,   70.,   50.,   50.,   15.,  200.,
             70.,  150.,   50.], dtype=float32), 'T2s': array([  0.      , 243.06877 ,  73.46702 ,  62.067276,  64.09466 ,
            42.323383,  42.323383,  14.274805, 116.12312 ,  64.09466 ,
            97.293144,  46.912655], dtype=float32), 'Chi': array([ 4.00e-07, -9.00e-06, -9.00e-06, -9.00e-06,  3.28e-06, -9.04e-06,
           -9.04e-06, -8.44e-06, -9.00e-06,  3.28e-06, -9.00e-06,  3.28e-06],
          dtype=float32)}




.. GENERATED FROM PYTHON SOURCE LINES 81-88

e.g., to be passed as ``**kwargs`` to a simulator routine.

Notice that segmentation can be accessed directly (in read-only mode)
via square bracked indexing, similarly to numpy arrays.

A basic summary of the properties can be accessed
via the ``__repr__`` attribute (i.e., enabling pretty printing):

.. GENERATED FROM PYTHON SOURCE LINES 88-127

.. code-block:: Python


    print(phantom2D)
    print(phantom3D)

    # We also provide a crisp segmentation, which has a lower memory footprint
    # at cost of a coarser approximation (i.e., a piecewise-constant tissue model)-
    #
    # This can be obtained starting from the `"fuzzy"` phantom as:

    phantom2D = phantom2D.as_crisp()
    phantom3D = phantom3D.as_crisp()

    # Print summary

    print(phantom2D)
    print(phantom3D)

    # Display spatial segmentations

    example2D = phantom2D

    example3Dax = np.concatenate((phantom3D[100], phantom3D[100], phantom3D[100]), axis=0)
    example3Dcor = np.concatenate(
        (phantom3D[::-1, 100], phantom3D[::-1, 100], phantom3D[::-1, 100]), axis=0
    )
    example3Dsag = np.concatenate(
        (phantom3D[::-1, :, 100], phantom3D[::-1, :, 100], phantom3D[::-1, :, 100]), axis=0
    )
    example3D = np.concatenate((example3Dax, example3Dcor, example3Dsag), axis=1)

    fig2, ax2 = plt.subplots(1, 2)
    ax2[0].imshow(example2D, cmap="turbo"), ax2[0].axis("off"), ax2[0].set_title(
        "2D phantom"
    )
    ax2[1].imshow(example3D, cmap="turbo"), ax2[1].axis("off"), ax2[1].set_title(
        "3D phantom"
    )
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_002.png
   :alt: 2D phantom, 3D phantom
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Fuzzy Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)
    Number of tissue classes: 12

    Fuzzy Brainweb phantom with following properties:
    Number of spatial dimensions: 3
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200, 200)
    Number of tissue classes: 12

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 3
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200, 200)





.. GENERATED FROM PYTHON SOURCE LINES 128-129

Crisp phantom can be also directly generated as:

.. GENERATED FROM PYTHON SOURCE LINES 129-138

.. code-block:: Python


    phantom2D = brainweb_phantom(ndim=2, subject=4, segtype="crisp")  # 2D phantom
    phantom3D = brainweb_phantom(ndim=3, subject=4, segtype="crisp")  # 3D phantom

    # N.B. ``segtype`` can be omitted as the default is ``"crisp"``.

    phantom2D = brainweb_phantom(ndim=2, subject=4)  # single-slice 2D phantom
    phantom3D = brainweb_phantom(ndim=3, subject=4)  # 3D phantom








.. GENERATED FROM PYTHON SOURCE LINES 139-146

Finally, we can obtain a "dense" phantom,
i.e., an object without segmentation whose
``(M0, T1, T2, T2*, Chi)`` properties are stored
as parametric maps rather than the individual values
of each tissue class.

This can be obtain (both from ``"fuzzy"`` and ``"crisp"`` models) as:

.. GENERATED FROM PYTHON SOURCE LINES 146-180

.. code-block:: Python


    phantom2D = phantom2D.as_numeric()

    # Print summary

    print(phantom2D)

    # Display parameter maps

    fig3, ax3 = plt.subplots(1, 5)

    im0 = ax3[0].imshow(phantom2D.M0, cmap="gray")
    ax3[0].axis("off"), ax3[0].set_title("M0 [a.u.]")
    fig3.colorbar(im0, ax=ax3[0], fraction=0.046, pad=0.04)

    im1 = ax3[1].imshow(phantom2D.T1, cmap="magma")
    ax3[1].axis("off"), ax3[1].set_title("T1 [ms]")
    fig3.colorbar(im1, ax=ax3[1], fraction=0.046, pad=0.04)

    im2 = ax3[2].imshow(phantom2D.T2, cmap="viridis", vmax=150)
    ax3[2].axis("off"), ax3[2].set_title("T2 [ms]")
    fig3.colorbar(im2, ax=ax3[2], fraction=0.046, pad=0.04)

    im3 = ax3[3].imshow(phantom2D.T2s, cmap="viridis", vmax=150)
    ax3[3].axis("off"), ax3[3].set_title("T2* [ms]")
    fig3.colorbar(im3, ax=ax3[3], fraction=0.046, pad=0.04)

    im4 = ax3[4].imshow(phantom2D.Chi, cmap="gray")
    ax3[4].axis("off"), ax3[4].set_title("Chi")
    fig3.colorbar(im4, ax=ax3[4], fraction=0.046, pad=0.04)

    plt.tight_layout()
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_003.png
   :alt: M0 [a.u.], T1 [ms], T2 [ms], T2* [ms], Chi
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dense Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)





.. GENERATED FROM PYTHON SOURCE LINES 181-182

Dense phantom can be also directly generated as:

.. GENERATED FROM PYTHON SOURCE LINES 182-189

.. code-block:: Python


    phantom2D = brainweb_phantom(ndim=2, subject=4, segtype=False)  # 2D phantom

    # Print summary

    print(phantom2D)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dense Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)





.. GENERATED FROM PYTHON SOURCE LINES 190-191

Hereafter, without loss of generality, we will use 2D phantoms.

.. GENERATED FROM PYTHON SOURCE LINES 193-201

By default, Brainweb phantoms are interpolated
to 1.085 mm isotropic resolution with a 200 isotropic matrix (217 mm iso FOV).

These can be adjusted using ``shape`` and ``output_res`` model:

1. ``shape`` will control the matrix size without affecting the resolution.
2. ``output_res`` will adjust the spatial resolution keeping the same (i.e., 200 iso) matrix


.. GENERATED FROM PYTHON SOURCE LINES 202-233

.. code-block:: Python


    phantom2D = brainweb_phantom(ndim=2, subject=4)
    phantom2D_mtx = brainweb_phantom(
        ndim=2, subject=4, shape=256
    )  # can also be shape=(ny, nx)
    phantom2D_res = brainweb_phantom(
        ndim=2, subject=4, output_res=2.0
    )  # can also be output_res=(dy, dx)
    phantom2D_mtx_res = brainweb_phantom(ndim=2, subject=4, shape=256, output_res=2.0)

    print(phantom2D)
    print(phantom2D_mtx)
    print(phantom2D_res)
    print(phantom2D_mtx_res)

    fig4, ax4 = plt.subplots(2, 2)
    ax4[0, 0].imshow(phantom2D, cmap="turbo"), ax4[0, 0].axis("off"), ax4[0, 0].set_title(
        "shape 200, res=1.085mm, fov=217mm"
    )
    ax4[0, 1].imshow(phantom2D_mtx, cmap="turbo"), ax4[0, 1].axis("off"), ax4[
        0, 1
    ].set_title("shape 256, res=1.085mm, fov=277mm")
    ax4[1, 0].imshow(phantom2D_res, cmap="turbo"), ax4[1, 0].axis("off"), ax4[
        1, 0
    ].set_title("shape 200, res=2.0mm, fov=400mm")
    ax4[1, 1].imshow(phantom2D_mtx_res, cmap="turbo"), ax4[1, 1].axis("off"), ax4[
        1, 1
    ].set_title("shape 256, res=2.0mm, fov=512mm")
    plt.show()





.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_004.png
   :alt: shape 200, res=1.085mm, fov=217mm, shape 256, res=1.085mm, fov=277mm, shape 200, res=2.0mm, fov=400mm, shape 256, res=2.0mm, fov=512mm
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (256, 256)

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (200, 200)

    Crisp Brainweb phantom with following properties:
    Number of spatial dimensions: 2
    Tissue properties: dict_keys(['M0', 'T1', 'T2', 'T2s', 'Chi'])
    Matrix size: (256, 256)





.. GENERATED FROM PYTHON SOURCE LINES 234-238

The physical parameter of each tissue class are calculated by
default for a field strength of 1.5 T.

This can be changed via the ``B0`` argument:

.. GENERATED FROM PYTHON SOURCE LINES 239-271

.. code-block:: Python


    # B0 strengths
    B0 = [0.55, 1.5, 3.0, 7.0, 11.7, 13.3]  # field strengths in [T]

    # Generate phantoms with different field strengths
    phantomB0 = [
        brainweb_phantom(ndim=2, subject=4, B0=strength, segtype=False) for strength in B0
    ]

    # Display
    T1 = np.concatenate([phantom.T1 for phantom in phantomB0], axis=1)
    T2 = np.concatenate([phantom.T2 for phantom in phantomB0], axis=1)
    T2s = np.concatenate([phantom.T2s for phantom in phantomB0], axis=1)

    fig5, ax5 = plt.subplots(3, 1)

    im1 = ax5[0].imshow(T1, cmap="magma", vmax=5000)
    ax5[0].axis("off"), ax5[0].set_title("T1 [ms]")
    fig5.colorbar(im1, ax=ax5[0], fraction=0.046, pad=0.04)

    im2 = ax5[1].imshow(T2, cmap="viridis", vmax=150)
    ax5[1].axis("off"), ax5[1].set_title("T2 [ms]")
    fig5.colorbar(im2, ax=ax5[1], fraction=0.046, pad=0.04)

    im3 = ax5[2].imshow(T2s, cmap="viridis", vmax=100)
    ax5[2].axis("off"), ax5[2].set_title("T2* [ms]")
    fig5.colorbar(im3, ax=ax5[2], fraction=0.046, pad=0.04)

    plt.tight_layout()
    plt.show()





.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_005.png
   :alt: T1 [ms], T2 [ms], T2* [ms]
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 272-290

In addition to single pool model, we provide 3 multi-pool models:

1. ``"mw-model"``: a two-pool model where free water is divided in two compartments,
   i.e., `intra-/extra-cellular water` (long T1 / T2) and `myelin water` (short T1 / T2).
   The model include chemical exchange between the two pools.
   Parameters are ``(MWF, T1, T2, k, chemshift)``.
2. ``"mt-model"``: a two-pool model consisting in `free water` and `bound water`.
   Free water includes both intra-/extra-cellular and myelin water (as in the single-pool model),
   while bound water corresponds to a macromolecular pool with the same T1 as the free water
   and no T2 (i.e., no transverse magnetiztion).
   The model include magnetization transfer between the two pools.
   Parameters are ``(MVF, T1, T2, k)``.
3. ``"mwmt-model"``: a three-pool model consisting in `intra-/extra-cellular water`, `myelin water` and `bound water`.
   The model include chemical exchange between the two free water pools and magnetizion transfer between
   myelin water and bound water.
   Parameters are ``(MWF, MVF, T1, T2, k)``.

Here we will display the latter, as it represents the most general case.

.. GENERATED FROM PYTHON SOURCE LINES 291-295

.. code-block:: Python


    # model="single-pool" is the default, while "mw-model" and "mt-model" corresponds to cases 1. and 2.
    phantom_multi = brainweb_phantom(ndim=2, subject=4, model="mwmt-model", segtype=False)








.. GENERATED FROM PYTHON SOURCE LINES 296-298

MWF corresponds to the myelin water fraction, while MVF to the bound water fraction.
We assume that intra-extracellular water fraction ``= 1 - (MWF + MVF)``:

.. GENERATED FROM PYTHON SOURCE LINES 299-311

.. code-block:: Python


    MWF = phantom_multi.MWF
    MVF = phantom_multi.MVF
    IEWF = (1 - (MWF + MVF)) * (MWF > 0)
    weight = np.concatenate((IEWF, MWF, MVF), axis=1)

    plt.figure()
    plt.imshow(weight, vmin=0, vmax=1, cmap="hot"), plt.axis("off"), plt.title(
        "pool fractions"
    ), plt.colorbar()
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_006.png
   :alt: pool fractions
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 312-315

T1 and T2 for the two free water pools are stacked along the first axis,
with ``n=0`` being the intra-/extra-cellular water (long T1 / T2) and
``n=1`` being the myelin water (short T1 / T2):

.. GENERATED FROM PYTHON SOURCE LINES 316-331

.. code-block:: Python


    T1 = np.concatenate((phantom_multi.T1[0], phantom_multi.T1[1]), axis=1)
    T2 = np.concatenate((phantom_multi.T2[0], phantom_multi.T2[1]), axis=1)

    fig6, ax6 = plt.subplots(2, 1)

    im1 = ax6[0].imshow(T1, cmap="magma", vmax=1500)
    ax6[0].axis("off"), ax6[0].set_title("T1 [ms]")
    fig6.colorbar(im1, ax=ax6[0], fraction=0.046, pad=0.04)

    im2 = ax6[1].imshow(T2, cmap="viridis", vmax=150)
    ax6[1].axis("off"), ax6[1].set_title("T2 [ms]")
    fig6.colorbar(im2, ax=ax6[1], fraction=0.046, pad=0.04)





.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_007.png
   :alt: T1 [ms], T2 [ms]
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <matplotlib.colorbar.Colorbar object at 0x7f5746ac6920>



.. GENERATED FROM PYTHON SOURCE LINES 332-335

k represent the non-directional exchange rates in [Hz],
with ``n=0`` being the chemical exchange rate between the two free water pools
and ``n=1`` being magnetization transfer rate between the myelin and bound water:

.. GENERATED FROM PYTHON SOURCE LINES 336-345

.. code-block:: Python


    k = np.concatenate((phantom_multi.k[0], phantom_multi.k[1]), axis=1)

    plt.figure()
    plt.imshow(k, cmap="hot"), plt.axis("off"), plt.title(
        "exchange rate [Hz]"
    ), plt.colorbar()
    plt.show()




.. image-sg:: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_008.png
   :alt: exchange rate [Hz]
   :srcset: /generated/autoexamples/01.Phantoms/images/sphx_glr_example_brainweb_008.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 346-386

Similarly to the single pool model, ``mrtwin`` supports ``"fuzzy"`` and ``"crisp"``
segmentations.

Caching mechanism
=================

To reduce loading times, `mrtwin` implements a caching mechanism.

If ``cache`` argument is set to ``True`` (default behaviour), each phantom
segmentation (identified by the number of spatial dimensions,
tissue model, segmentation type, matrix shape and resolution)
is saved on the disk in ``npy`` format.

The path is selected according to the following hierachy (inspired by ``brainweb-dl``):

1. User-specific argument (``cache_dir``)
2. ``MRTWIN_DIR`` environment variable
3. ``~/.cache/mrtwin`` folder

On top of that, the underlying Brainweb fuzzy segmentations at the original
resolution are stored (via ``brainweb-dl``) with the following hierachy:

1. User-specific argument (``brainweb_dir``)
2. ``BRAINWEB_DIR`` environment variable
3. ``~/.cache/brainweb`` folder

The cached files can be forcibly overwritten by setting the ``force`` argument
to ``True`` (default: ``False``).

N.B.: currently, ``force=True`` will both force re-downloading brainweb segmentation
and the subsequent interpolations and resizing required to obtain the
desired shape and resolution.

Disabling SSL verification (not recommended)
============================================

If you encounter some issue in downloading, SSL verification
can be disabled by setting ``verify`` to ``False`` (default: ``True``).
It is advised however to solve the problem on your machine side
(updating the certificate).


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 30.719 seconds)


.. _sphx_glr_download_generated_autoexamples_01.Phantoms_example_brainweb.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/infn-mri/mrtwin/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/01.Phantoms/example_brainweb.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_brainweb.ipynb <example_brainweb.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_brainweb.py <example_brainweb.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_brainweb.zip <example_brainweb.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_

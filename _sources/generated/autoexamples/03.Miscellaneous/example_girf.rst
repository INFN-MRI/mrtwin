
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "generated/autoexamples/03.Miscellaneous/example_girf.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_generated_autoexamples_03.Miscellaneous_example_girf.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_generated_autoexamples_03.Miscellaneous_example_girf.py:


===========================================
Gradien System Response Function Generation
===========================================

Example of Gradien System Response Function (GIRF) generation.

The GIRF is approximated as a complex-valued array, whose magnitude (modeled)
as a Gaussian of the specified Full Width Half Maximum, which dampens
high-frequency components of the k-space trajectory, and whose phase
is a linear ramp representing a non-integer shift of the waveform.

The response is modeled independently for the three physical axes ``z, y, x``.

.. GENERATED FROM PYTHON SOURCE LINES 16-22

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    from mrtwin import generate_girf








.. GENERATED FROM PYTHON SOURCE LINES 23-34

Typical values for gradient raster times ``dt`` are around 5-10 us
(GE: 4us; Siemens: 10us; Philips: 6.4us)

GIRF magnitudes Full Width Half Maximum are on the order of 5 kHz,
while gradient delays are on the order of 1us.

GIRF for the x and y axes are more similar to each other
when compared to z axes.

Given a GIRF measurement time window of 100ms, function parameters are
as follows:

.. GENERATED FROM PYTHON SOURCE LINES 35-41

.. code-block:: Python


    dt = 4e-6  # assume GE raster time
    N = int(100e-3 // dt)  # approximate number of points
    fwhm = (8.0e3, 5.9e3, 6.1e3)
    delay = (3.2e-6, 0.9e-6, 1.1e-6)








.. GENERATED FROM PYTHON SOURCE LINES 42-43

Given these parameters, GIRF can be computed as

.. GENERATED FROM PYTHON SOURCE LINES 43-53

.. code-block:: Python


    freqs, girf = generate_girf(dt, N, fwhm, delay)

    fig, ax = plt.subplots(2, 1)
    ax[0].plot(freqs * 1e-3, np.abs(girf).T, "."), ax[0].set_xlim([-10, 10]), ax[0].legend(
        ["$GIRF_z$", "$GIRF_y$", "$GIRF_x$"]
    ), ax[0].set(xlabel="frequency [kHz]", ylabel="GIRF magnitude")
    ax[1].plot(freqs * 1e-3, np.angle(girf).T, "."), ax[1].set_xlim([-10, 10]), ax[
        1
    ].set_ylim([-0.5, 0.5]), ax[1].set(xlabel="frequency [kHz]", ylabel="GIRF phase [rad]")



.. image-sg:: /generated/autoexamples/03.Miscellaneous/images/sphx_glr_example_girf_001.png
   :alt: example girf
   :srcset: /generated/autoexamples/03.Miscellaneous/images/sphx_glr_example_girf_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    ([<matplotlib.lines.Line2D object at 0x7fce76ec49d0>, <matplotlib.lines.Line2D object at 0x7fce76ec4d30>, <matplotlib.lines.Line2D object at 0x7fce76ec5390>], (-10.0, 10.0), (-0.5, 0.5), [Text(0.5, 23.52222222222222, 'frequency [kHz]'), Text(31.222222222222214, 0.5, 'GIRF phase [rad]')])




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.180 seconds)


.. _sphx_glr_download_generated_autoexamples_03.Miscellaneous_example_girf.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/infn-mri/mrtwin/gh-pages?urlpath=lab/tree/examples/generated/autoexamples/03.Miscellaneous/example_girf.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_girf.ipynb <example_girf.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_girf.py <example_girf.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_girf.zip <example_girf.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
